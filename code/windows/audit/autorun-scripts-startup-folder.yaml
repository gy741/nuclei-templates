id: autorun-scripts-startup-folder

info:
  name: Autorun Scripts in Startup Folder
  author: princechaddha
  severity: medium
  description: Detect unauthorized scripts or executables in startup folders.
  impact: |
    Unauthorized scripts or executables can lead to the execution of malicious software during system startup.
  remediation: |
    Remove any unauthorized scripts or executables from the startup folder and implement security policies to restrict future unauthorized additions.
  tags: windows,startup,autorun,code,windows-audit

self-contained: true

code:
  - pre-condition: |
      IsWindows();
    engine:
      - powershell
      - powershell.exe
    args:
      - -ExecutionPolicy
      - Bypass
    pattern: "*.ps1"
    source: |
      Get-ChildItem -Path "$env:ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp"

    matchers:
      - type: word
        words:
          - ".exe"
          - ".ps1"

# digest: 4a0a00473045022100c6cfd66abd8c4b3e1d807799cb221baf9de2f32f7212cd377a62286a35760487022024ef822b4986bd6e5d879e6715209165b9cf325281d40279d6f9a0d6cf417999:922c64590222798bb761d5b6d8e72950